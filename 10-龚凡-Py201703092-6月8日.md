# 第三期运维课程笔记

## Data：2017-06-08 Author：阿凡提 Content：认识Linux

### 一、Linux介绍
Linux是一套免费使用和自由传播的类Unix操作系统，是一个基于POSIX和UNIX的多用户、多任务、支持多线程和多CPU的操作系统。它能运行主要的UNIX工具软件、应用程序和网络协议。
 
### 二、Linux主要特性
#### 1.一切都是文件。
详细来讲就是系统中的所有都归结为一个文件，包括命令、硬件和软件设备、操作系统、进程等等对于操作系统内核而言，都被视为拥有各自特性或类型的文件。

#### 2.每个软件都有确定的用途。

#### 3.多用户、多任务
* Linux支持多用户，各个用户对于自己的文件设备有自己特殊的权利，保证了各用户之间互不影响。
* 多任务则是现在电脑最主要的一个特点，Linux可以使多个程序同时并独立地运行。

 
### 三、Linux文件类型
#### 1.普通文件（regular file）
就是一般存取的文件，由ls -al显示出来的属性中，第一个属性为 [-]，例如 [-rwxrwxrwx]。另外，依照文件的内容，又大致可以分为：

* 纯文本文件（ASCII）

这是Unix系统中最多的一种文件类型，之所以称为纯文本文件，是因为内容可以直接读到的数据，例如数字、字母等等。设置文件几乎都属于这种文件类型。举例来说，使用命令“cat~/.bashrc”就可以看到该文件的内容（cat是将文件内容读出来）。

* 二进制文件（binary）

系统其实仅认识且可以执行二进制文件（binary file）。
Linux中的可执行文件（脚本，文本方式的批处理文件不算）就是这种格式的。举例来说，命令cat就是一个二进制文件。

* 数据格式的文件（data）

有些程序在运行过程中，会读取某些特定格式的文件，那些特定格式的文件可以称为数据文件（data file）。举例来说，Linux在用户登入时，都会将
登录数据记录在 /var/log/wtmp文件内，该文件是一个数据文件，它能通过last命令读出来。但使用cat时，会读出乱码。因为它是属于一种特殊格式的文件。

#### 2.目录文件（directory）
就是目录，第一个属性为 [d]，例如 [drwxrwxrwx]。

#### 3.连接文件（link）
类似Windows下面的快捷方式。第一个属性为 [l]，例如 [lrwxrwxrwx]。

#### 4.设备与设备文件（device）
与系统外设及存储等相关的一些文件，通常都集中在/dev目录。通常又分为两种：
* 块设备文件

就是存储数据以供系统存取的接口设备，简单而言就是硬盘。例如一号硬盘的代码是 /dev/hda1等文件。第一个属性为 [b]。

* 字符设备文件

即串行端口的接口设备，例如键盘、鼠标等等。第一个属性为 [c]。

#### 5.套接字（sockets）
这类文件通常用在网络数据连接。可以启动一个程序来监听客户端的要求，客户端就可以通过套接字来进行数据通信。第一个属性为 [s]，最常在 /var/run目录中看到这种文件类型。

#### 6.管道（FIFO,pipe）
FIFO也是一种特殊的文件类型，它主要的目的是，解决多个程序同时存取一个文件所造成的错误。FIFO是first-in-first-out（先进先出）的缩写。第一个属性为 [p]
  
### 三、Linux工作目录
#### `/`：根目录，所有的目录、文件、设备都在/之下者。 
```
[root@vagrant-centos65 /]# ls
bin  boot  dev  etc  home  lib  lib64  lost+found  media  mnt  opt  proc  root  sbin  selinux  srv  sys  tmp  usr  vagrant  var
```

#### `/bin`：系统所需要的那些命令位于此目录。
```
[root@vagrant-centos65 bin]# ls
arch      chmod  date           dumpkeys  fgrep       grep      iptables-xml        ln        mkdir       mv             plymouth  rmdir    sh     tar         ulockmgr_server  usleep
awk       chown  dd             echo      find        gtar      iptables-xml-1.4.7  loadkeys  mknod       netstat        ps        rpm      sleep  taskset     umount           vi
basename  cp     df             egrep     findmnt     gunzip    kbd_mode            logger    mktemp      nice           pwd       rvi      sort   touch       uname            view
bash      cpio   dmesg          env       fusermount  gzip      keyctl              login     more        nisdomainname  raw       rview    stty   tracepath   unicode_start    ypdomainname
cat       cut    dnsdomainname  ex        gawk        hostname  kill                ls        mount       ping           readlink  sed      su     tracepath6  unicode_stop     zcat
chgrp     dash   domainname     false     gettext     ipcalc    link                lsblk     mountpoint  ping6          rm        setfont  sync   true        unlink
```

#### `/boot`：Linux的内核及引导系统程序所需要的文件目录
比如 vmlinuz initrd.img 文件都位于这个目录中。在一般情况下，GRUB或LILO系统引导管理器也位于这个目录。
```
[root@vagrant-centos65 boot]# ls
config-2.6.32-431.3.1.el6.x86_64  efi  grub  initramfs-2.6.32-431.3.1.el6.x86_64.img  symvers-2.6.32-431.3.1.el6.x86_64.gz  System.map-2.6.32-431.3.1.el6.x86_64  vmlinuz-2.6.32-431.3.1.el6.x86_64
```

#### `/cdrom`：挂载光驱的目录
这个目录在刚刚安装系统的时候是空的。可以将光驱文件系统挂在这个目录下。例如：mount /dev/cdrom /cdrom

#### `/dev`：这个目录中包含了所有linux系统中使用的外部设备。
但是这里并不是放的外部设备的驱动程序。这一点和常用的windows,dos操作系统不一样。它实际上是一个访问这些外部设备的端口。可以非常方便地去访问这些外部设备，和访问一个文件，一个目录没有任何区别。
```
[root@vagrant-centos65 dev]# ls
block            disk       hvc0   loop4  MAKEDEV             nvram   ram10  ram4    root  sg1       tty0   tty16  tty23  tty30  tty38  tty45  tty52  tty6   ttyS0      vcs   vcsa1
bsg              fb         input  loop5  mapper              oldmem  ram11  ram5    rtc   shm       tty1   tty17  tty24  tty31  tty39  tty46  tty53  tty60  ttyS1      vcs1  vcsa2
char             fb0        kmsg   loop6  mcelog              port    ram12  ram6    rtc0  snapshot  tty10  tty18  tty25  tty32  tty4   tty47  tty54  tty61  ttyS2      vcs2  vcsa3
console          fd         log    loop7  mem                 ppp     ram13  ram7    sda   stderr    tty11  tty19  tty26  tty33  tty40  tty48  tty55  tty62  ttyS3      vcs3  vcsa4
core             full       loop0  lp0    net                 ptmx    ram14  ram8    sda1  stdin     tty12  tty2   tty27  tty34  tty41  tty49  tty56  tty63  urandom    vcs4  vcsa5
cpu              fuse       loop1  lp1    network_latency     pts     ram15  ram9    sdb   stdout    tty13  tty20  tty28  tty35  tty42  tty5   tty57  tty7   usbmon0    vcs5  vcsa6
cpu_dma_latency  hpet       loop2  lp2    network_throughput  ram0    ram2   random  sdb1  systty    tty14  tty21  tty29  tty36  tty43  tty50  tty58  tty8   vboxguest  vcs6  vga_arbiter
crash            hugepages  loop3  lp3    null                ram1    ram3   raw     sg0   tty       tty15  tty22  tty3   tty37  tty44  tty51  tty59  tty9   vboxuser   vcsa  zero
```

#### `/etc`：存放系统管理时要用到的各种配置文件和子目录。
要用到的网络配置文件，文件系统，x系统配置文件，设备配置信息，设置用户信息等都在这个目录下。
```
[root@vagrant-centos65 etc]# ls
adjtime            cron.daily    DIR_COLORS               gnupg             init.d         localtime       multipath       pki        rc2.d             rpm            shells          system-release
aliases            cron.deny     DIR_COLORS.256color      group             inittab        login.defs      my.cnf          plymouth   rc3.d             rsyslog.conf   skel            system-release-cpe
aliases.db         cron.hourly   DIR_COLORS.lightbgcolor  group-            inputrc        logrotate.conf  netconfig       pm         rc4.d             rsyslog.d      ssh             terminfo
alternatives       cron.monthly  dracut.conf              grub.conf         iproute2       logrotate.d     NetworkManager  popt.d     rc5.d             rwtab          ssl             udev
anacrontab         crontab       dracut.conf.d            gshadow           iscsi          lvm             networks        postfix    rc6.d             rwtab.d        statetab        vimrc
audisp             cron.weekly   environment              gshadow-          issue          magic           nfsmount.conf   ppp        rc.d              sasl2          statetab.d      virc
audit              crypttab      ethers                   gssapi_mech.conf  issue.net      makedev.d       nsswitch.conf   printcap   rc.local          securetty      subversion      X11
bash_completion.d  csh.cshrc     exports                  host.conf         krb5.conf      man.config      openldap        profile    rc.sysinit        security       sudo.conf       xdg
bashrc             csh.login     favicon.png              hosts             ld.so.cache    mercurial       opt             profile.d  redhat-release    selinux        sudoers         xinetd.d
blkid              dbus-1        filesystems              hosts.allow       ld.so.conf     mke2fs.conf     pam.d           protocols  request-key.conf  services       sudoers.d       yum
centos-release     default       fstab                    hosts.deny        ld.so.conf.d   modprobe.d      passwd          rc         request-key.d     sestatus.conf  sudo-ldap.conf  yum.conf
chkconfig.d        depmod.d      gai.conf                 idmapd.conf       libaudit.conf  motd            passwd-         rc0.d      resolv.conf       shadow         sysconfig       yum.repos.d
cron.d             dhcp          gcrypt                   init              libuser.conf   mtab            pkcs11          rc1.d      rpc               shadow-        sysctl.conf
```

#### `/home`：家目录
如果建立一个用户，用户名是"xx",那么在/home目录下就有一个对应的/home/xx路径，用来存放用户的主目录
```
[root@vagrant-centos65 home]# ls
vagrant
```

#### `/lib`：这个目录是用来存放系统动态连接共享库的。
几乎所有的应用程序都会用到这个目录下的共享库。因此，千万不要轻易对这个目录进行什么操作，一旦发生问题，系统就不能工作了。


#### `/lost+found`：分区修复时找回来的文件会存放在这里，存放一些系统不正常关机的文件
在ext2或ext3文件系统中，当系统意外崩溃或机器意外关机，而产生一些文件碎片放在这里。当系统启动的过程中fsck工具会检查这里，并修复已经损坏的文件系统。有时系统发生问题，有很多的文件被移到这个目录中，可能会用手工的方式来修复，或移到文件到原来的位置上。

#### `/mnt`：用于挂载的目录
这个目录一般是用于存放挂载储存设备的挂载目录的，比如有cdrom等目录。

#### `/media`：用于挂载的目录
有些linux的发行版使用这个目录来挂载那些usb接口的移动硬盘（包括U盘）、CD/DVD驱动器等等。

#### `/opt`：用于存放第三方软件可选目录

#### `/proc`：可以在这个目录下获取系统信息。这些信息是在内存中，由系统自己产生的。
这个目录本身是一个虚拟文件系统（virtual filesystem）。它放置的数据都是在内存当中，例如系统内核、进（process）、外部设备的状态及网络状态等。因为这个目录下的数据都是在内存当中，所以本身不占任何硬盘空间！比较重要的文件例如`/proc/cpuinfo`、`/proc/dma`、`/proc/interrupts`、`/proc/ioports`、`/proc/net/*`等。

#### `/root`：Linux超级权限用户root的家目录。

#### `/sbin`：存放系统管理员的系统管理程序。
大多是涉及系统管理的命令的存放，是超级权限用户root的可执行命令存放地，普通用户无权限执行这个目录下的命令，这个目录和`/usr/sbin`; `/usr/X11R6/sbin`或`/usr/local/sbin`目录是相似的，凡是目录sbin中包含的都是root权限才能执行的。

#### `/selinux`：对SElinux的一些配置文件目录，SElinux可以让linux更加安全。

#### `/tmp`：临时文件目录，用来存放不同程序执行时产生的临时文件。
有时用户运行程序的时候，会产生临时文件。`/tmp`就用来存放临时文件的。`/var/tmp`目录和这个目录相似。

#### `/usr`:存放第三方软件
usr 是 UNIX Software Resource
的缩写。即“UNIX操作系统软件资源”所放置的目录，而不是用户数据。

#### `/usr/local`：这里主要存放那些手动安装的软件，即不是通过“新立得”或apt-get安装的软件。
它和/usr目录具有相类似的目录结构。让软件包管理器来管理/usr目录，而把自定义的脚本（scripts)放到/usr/local目录下面。

#### `/usr/share`：系统共用的东西存放地，比如 `/usr/share/fonts` 是字体目录，`/usr/share/doc`和`/usr/share/man`帮助文件。

#### `/var`：存放日志或者频繁修改的文件
主要针对常态性变动的文件，`/var`下有`/var/log`这是用来存放系统日志的目录。`/var/www`目录是定义Apache服务器站点存放目录；`/var/lib` 用来存放一些库文件，比如MySQL的，以及MySQL数据库的的存放地。


### 四、linux基本命令
#### 1.绝对路径
以正斜线“/”开头，描述道文件位置的完整说明  
cd /tmp/aa  

#### 2.相对路径  
不以正斜线开头，制定相对于你的当前工作目录而言的位置    
cd ../tmp   

#### 3.查看当前目录（pwd）
```
[root@vagrant-centos65 ~]# pwd [-P]
参数：
-P：显示出当前的路径，而非使用链接（link）路径
```  

#### 4.切换目录(cd)
```
[root@vagrant-centos65 ~]# cd [相对路径或绝对路径]
相对路径：路径由非/开头
绝对路径：路径由根目录/开头    例如：/usr/share/doc
.      代表此层目录
..     代表上一层目录
-      代表前一个工作目录
~      代表“目前用户身份”所在的主文件夹
```

#### 5.新建目录（mkdir）
```
[root@vagrant-centos65 ~]# mkdir [-p] 目录名称
参数：
-p：帮助你直接将所需要的目录（包含上层目录）递归创建起来
[root@vagrant-centos65 tmp]# mkdir -p bbb/ccc
```

#### 6.删除目录（rmdir）
```
[root@vagrant-centos65 ~]# rmdir [-p] 目录名称
参数：
-p：连同上层的“空的”目录页一起删除掉
```

#### 7.查看文件或目录
```
[root@vagrant-centos65 ~]# ls [-aAdfFhilnrRSt] 目录名称
参数：
-a：全部的文件，连同隐藏文件（开头为  . 的文件）一起列出来（常用）
-A：列出全部的文件（连同隐藏文件，但不包括 . 与 .. 这两个目录）
-d：仅列出目录本身，而不是列出目录内的文件数据（常用）
-F：根据文件、目录等信息给予附加数据结构，例如：
	*：代表可执行文件；  /：代表目录；  =：代表 socket 文件；   |：代表 FIFO 文件
-h：将文件容量以人类较易读的方式（例如 GB、KB等）列出来
-l：列出长数据串，包含文件的属性与权限等数据（常用）
-n：列出 UID 与 GID，而非用户与用户组的名称（UID 和 GID会在账号管理提到）
-R:连同子目录内容一起列出来，等于该目录下的所有文件都会显示出来
```

#### 8.复制文件或目录（cp）
```
[root@vagrant-centos65 ~]# cp [-adfilprsu] 源文件（soursce） 目标文件（destination）
[root@vagrant-centos65 ~]# cp [options] source1 source2 source3 .... derectory
参数：
-a：相当于 -pdr 的意思（常用）
-d：若源文件为链接文件的属性（link file），则复制链接文件属性而非文件本身
-f：为强制（force）的意思，若目标文件已经存在时，则删除后再尝试一次
-i：若目标文件（destination）已经存在时，在覆盖时会先询问操作的进行（常用）
-l：进行硬链接（head link）的链接文件创建，而非复制文件本身
-p:连同文件的属性一起复制过去，而非使用默认属性（备份常用）
-r：递归持续复制，用于目录的复制行为（常用）
-u:若 destination 比 source 旧才更新 destination
注意：如果源文件有两个以上，则最后一个目的文件一定要是“目录”才行
```

#### 9.删除文件或目录（rm）
```
[root@vagrant-centos65 ~]# rm [-fir] 文件或目录
参数：
-f：就是 force 的意思，忽略不存在的文件，不会出现警告信息
-i：互动模式，在删除前会询问用户是否操作
-r:递归删除。最常用在目录的删除，这是非常危险的猜参数！！！！！
```

#### 10.移动文件或目录（mv）
```
[root@vagrant-centos65 ~]# mv [-fiu] source destination
[root@vagrant-centos65 ~]# mv [options] source1 source2 source3 .... directory
参数：
-f：force 强制的意思，如果目标文件已经存在，不会询问而直接覆盖
-i：若目标文件（destination）已经存在时，就会询问是否覆盖
-u：若目标文件已经存在，且 source 比较新，才会更新（update）
```

#### 11.查看文件内容（cat）
```
[root@vagrant-centos65 ~]# cat [-AbEnTv]
参数：
-A：相当于 -vET 的整合参数，可列出一些特殊字符，而不是空白而已
-b:列出行号，仅针对非空白行做行号显示，空白行不标行号
-E：将结尾的断行符号 $ 显示出来
-n：打印出行号，连同空白行也会有行号，与 -b 的参数不同
-T：将 [Tab] 按键以 ^I 显示出来
-v：列出一些看不出来的特殊字符
```

#### 12.修改文件时间或创建新文件
  * modification time（mtime）

    当该文件的“内容数据”更改时，就会更新这个时间。内容数据指的是文件的内容，而不是文件的属性或权限

  * status time （ctime）

    当该文件的在“状态”（status）改变时，就会更新这个时间，举例来说，像是权限与属性被更改了，都会更新这个时间

  * access time（atime）

    当“该文件的内容被取用”时，就会更新这个时间，举例来说，我们使用`cat`去读取 `/etc/man.config`,就会更新改文件的 atime 了
```
[root@vagrant-centos65 ~]# touch [-acdmt] file
参数：
-a：仅修改访问时间
-c：仅修改文件的时间，若该文件不存在则创建新文件
-d：后面可以接欲修改的日期而不用目前的日期，也可以使用 --date="日期或时间"
-m：仅修改mtime
-t：后面可以接修改的时间而不用目前的时间，格式为 [YYMMDDhhmm]
```

#### 13.查找特定文件（whereis）
```
[root@vagrant-centos65 ~]# whereis [-bmsu] 文件或目录
参数：
-b：只找二进制格式的文件
-m：只找在说明文件 manual 路径下的文件
-s：只找 source 源文件
-u：查找不在上述三个选项当中的其他特殊文件
```

#### 14.查找文件（locate）
locate命令用于查找文件，它比find命令的搜索速度快，它需要一个数据库，这个数据库由每天的例行工作（crontab）程序来建立。当我们建立好这个数据库后，就可以方便地来搜寻所需文件了。

即先运行：`updatedb`（无论在那个目录中均可，可以放在crontab中 ）后在`/var/lib/slocate/` 下生成 `slocate.db`
数据库即可快速查找。在命令提示符下直接执行`#updatedb` 命令即可。
```
[root@vagrant-centos65 ~]# locate [ir] keyword
参数：
-i：忽略大小写的差异
-r：后面可接正则表达式的显示方式
```

#### 15.查找文件（find）
```
[root@vagrant-centos65 ~]# find [PATH] [options] [action]
参数：
-name   按照文件名查找文件。
```

#### 16.关机/重启  
halt -p或poweroff －－马上关机  
init 0－－马上关机  
shutdown -h now	－－马上关机  
reboot (halt)	--马上重启  
shutdown -r +10 (now)	－－10分钟后(马上)重启  
init 6 重启电脑
```
init <--改变系统的运行级别 ，下面的定义在/etc/inittab文件设定  
0 --- 关机  
1 --- 默认没有用户和密码验证，单用户模式，忘记管理员密码用来修改密码，或者一些简单的排错  
2 --- 不带网络的文本模式  
3 --- 带网络的文本模式  
4 --- 保留，没用  
5 --- 带图形的模式  
6 --- 重启电脑  

shutdown -r 重启电脑  
shutdown -P 直接关闭电源  
shutdown -h 15:00 <---设定电脑15:00就关机  
shutdown -h 14:35 "Hurry up. The system is shutting down " &  
shutdown -c 取消计划中的关机或者重启  
```

#### 17.根据给定格式显示日期或设定系统日期时间（date）
```
* 设置系统时间
  [root@DB-Server ~]# date -s "2017-06-08 00:00:00"
* 显示日期
  date "+%Y-%m-%d %H:%M:%S" 
```